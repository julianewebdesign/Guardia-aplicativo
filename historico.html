<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GuardIA - Histórico de Rotas</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
  body {
    font-family:'Poppins',sans-serif;
    margin:0;
    background:#f9f9fb;
    color:#333;
    max-width:480px;
    margin:auto;
  }

  .header {
    display:flex;
    align-items:center;
    gap:12px;
    padding:15px;
    background:#fff;
    box-shadow:0 2px 5px rgba(0,0,0,0.1);
    cursor:pointer;
    position:relative;
    z-index:1001;
  }
  .header img { height:80px; width:80px; }
  .header h1 { font-size:36px; color:#ed83a6; margin:0; }

  .sidebar {
    position:fixed;
    top:0;
    left:-240px;
    width:240px;
    height:100%;
    background:#fff;
    box-shadow:2px 0 10px rgba(0,0,0,0.2);
    padding:20px;
    overflow-y:auto;
    transition:0.3s;
    z-index:1000;
  }
  .sidebar.active { left:0; }
  .sidebar h2 { font-size:18px; color:#ed83a6; margin-bottom:15px; }
  .sidebar ul { list-style:none; padding:0; }
  .sidebar ul li { padding:10px 0; cursor:pointer; font-weight:500; color:#444; }
  .sidebar ul li:hover { color:#ed83a6; }

  .main { padding:20px; }

  #map { height:300px; border-radius:15px; margin-bottom:20px; }

  .buttons { display:flex; flex-direction:column; gap:10px; margin-bottom:15px; }
  .btn {
    padding:12px;
    border-radius:12px;
    font-weight:600;
    cursor:pointer;
    text-align:center;
    color:#fff;
    background: linear-gradient(135deg, #f4a0c2, #ed9bb6);
    transition:0.25s;
  }
  .btn:hover { transform:translateY(-2px); box-shadow:0 6px 14px rgba(0,0,0,0.15); }

  .history { background:#fce4ec; padding:10px; border-radius:12px; font-size:13px; max-height:250px; overflow-y:auto; }

  label { display:flex; align-items:center; gap:10px; margin-bottom:12px; font-size:16px; }
  input[type=time] { padding:12px; border-radius:8px; border:1px solid #ccc; font-size:16px; width:120px; }
  input[type=checkbox] { width:20px; height:20px; }
</style>
</head>
<body>

<!-- Sidebar -->
<div class="sidebar" id="sidebar">
  <h2>Menu</h2>
  <ul>
        <li><a href="guardia.html">Painel</a></li>
    <li onclick="alert('Configurações')">Configurações</li>
    <li onclick="alert('Fórum')">Fórum</li>
    <li onclick="alert('Notícias')">Notícias</li>
    <li onclick="alert('Educação')">Educação</li>
    <li onclick="alert('Cadastro')">Cadastro</li>
    <li onclick="document.getElementById('routes').scrollIntoView()">Histórico de rotas</li>
    <li onclick="alert('Interface Premium')">Interface (Premium)</li>
    <li onclick="alert('Armazenamento')">Armazenamento de usuária</li>
    <li onclick="alert('Proteção à criança')">Proteção à criança</li>
  </ul>
</div>

<div class="main">
  <div class="header">
    <img src="assets/guardia.png" alt="Logo GuardIA" onclick="toggleMenu()">
    <h1>GuardIA</h1>
  </div>

  <h2>Histórico de Rotas</h2>


  <div id="map"></div>

  <!-- Controle do histórico -->
  <div class="section" id="routes">
    <h3>Opções do Histórico</h3>
    <div class="buttons">
      <div class="btn" onclick="activateHistory()">Ativar Histórico</div>
      <div class="btn" onclick="deactivateHistory()">Desativar Histórico</div>
      <div class="btn" onclick="viewAllRoutes()">Visualizar todas as rotas</div>
    </div>

    <h4>Configurações automáticas</h4>
    <label>Início automático: <input type="time" id="startTime" value="18:00"></label>
    <label>Término automático: <input type="time" id="endTime" value="23:00"></label>
    <label><input type="checkbox" id="alwaysOn"> Histórico 24h</label>

    <div class="history" id="history">Nenhuma rota registrada ainda.</div>
  </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
  // MAPA
  const map = L.map('map').setView([-23.55052, -46.633308], 13);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution:'© OpenStreetMap' }).addTo(map);

  // MENU
  const sidebar = document.getElementById('sidebar');
  function toggleMenu() { sidebar.classList.toggle('active'); }

  // HISTÓRICO
  let historyEnabled = false;
  let routesLogged = [];
  let routeInterval = null;

  function generateAddress() {
    const streets = ['Rua A', 'Rua B', 'Rua C', 'Rua D', 'Avenida X', 'Avenida Y'];
    return streets[Math.floor(Math.random()*streets.length)];
  }

  function updateHistory() {
    if(!historyEnabled) return;
    const now = new Date();
    const address = generateAddress();
    routesLogged.push({time: now.toLocaleTimeString(), address});
    document.getElementById('history').innerHTML = routesLogged.map(r => `${r.time}: ${r.address}`).join('<br>');
  }

  // Funções de controle
  function activateHistory() {
    if(historyEnabled) return alert('Histórico já ativado');
    historyEnabled = true;
    updateHistory();
    routeInterval = setInterval(updateHistory, 5*60*1000); // a cada 5 minutos
    alert('Histórico ativado');
  }

  function deactivateHistory() {
    historyEnabled = false;
    clearInterval(routeInterval);
    routeInterval = null;
    alert('Histórico desativado');
  }

  function viewAllRoutes() {
    if(routesLogged.length === 0) return alert('Nenhuma rota registrada ainda.');
    const all = routesLogged.map(r => `${r.time}: ${r.address}`).join('\n');
    alert(all);
  }

  // Automatização por horário definido manualmente ou 24h
  setInterval(() => {
    const now = new Date();
    const currentTime = now.getHours().toString().padStart(2,'0') + ':' + now.getMinutes().toString().padStart(2,'0');
    const startTime = document.getElementById('startTime').value;
    const endTime = document.getElementById('endTime').value;
    const alwaysOn = document.getElementById('alwaysOn').checked;

    if(alwaysOn && !historyEnabled) activateHistory();
    if(!alwaysOn) {
      if(currentTime === startTime && !historyEnabled) activateHistory();
      if(currentTime === endTime && historyEnabled) deactivateHistory();
    }
  }, 60*1000); // verifica a cada minuto

</script>

</body>
</html>


